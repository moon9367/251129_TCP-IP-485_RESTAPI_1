================================================================================
📌 Cursor AI 고정 규칙 문서 (Master Prompt)
================================================================================

【 이 문서는 AI가 모든 작업 시 필수적으로 참조해야 하는 최우선 규칙입니다 】


0. 기본 원칙
================================================================================
이 프로젝트는 RS485(Modbus) → TCP/IP 변환 테스트를 먼저 완성하고,
이후 이를 기반으로 REST API 서버로 변환하는 2단계 구조입니다.

모든 답변은 아래 구조·규칙을 절대적으로 유지해야 합니다.


1. 문서 구조 규칙 (최우선 고정)
================================================================================
문서는 반드시 두 개의 대문서로 분리하여 관리합니다.

📄 문서 A — "RS485(Modbus → TCP/IP) 변환 기술 문서"
    • RS485 Modbus RTU/TCP Read/Write
    • ON/OFF (0/1)
    • 센서값 읽기
    • Register 숫자값 변경 테스트 (시간, 설정온도 등)
    • 테스트 규칙 및 응답 포맷 통일
    • 오류 처리 규칙
    • 통신 규격 / 주소 체계
    • 섹션별 내용은 절대 변형 없이 일관하게 유지

📄 문서 B — "REST API 변환 기술 문서"
    • 문서 A 내용을 기반으로 만들어진 REST API
    • 동일 기능의 Read/Write/Set 명령을 REST화
    • 엔드포인트 설계
    • 요청/응답 JSON 규칙
    • 상태코드 규칙
    • 인증/보안
    • 향후 확장 구조

⚠️ 문서 A와 B는 절대로 섞지 않습니다.


2. 섹션 유지 규칙
================================================================================
Cursor는 질문이 반복될 때 내용을 덧붙이거나 변형하려는 경향이 있기 때문에
아래 규칙을 항상 유지합니다:

✓ 모든 섹션은 "고정 템플릿"으로 관리한다.
✓ 특정 섹션에 대한 "읽기 기능", "쓰기 기능", "예시 코드" 등을 요청하더라도
  기존 섹션은 수정하지 말고, 추가 설명은 반드시 'Appendix' 형태로만 추가한다.
✓ 동일 기능(예: Read 기능)은 매번 동일한 규칙/포맷으로 작성한다.
✓ 불필요한 추측·확장 설명 금지.
✓ 문서 간 교차·혼합 절대 금지.


3. 작업 방식
================================================================================

3-1. 요청 가능한 작업 유형
------------------------
• "문서 A에 ○○ 섹션 추가"
• "문서 A의 Read 규칙을 기반으로 테스트 예시 작성"
• "문서 B의 REST API 엔드포인트 설계 작성"
• "Appendix로 상세 예시만 덧붙이기"
• "두 문서 중 어디에 적어야 할지 먼저 판단해줘"
• "문서 전체 구조표 다시 정리해줘"

3-2. Cursor의 답변 규칙
------------------------
모든 답변은 아래 템플릿 중 하나로만 합니다:

🟦 템플릿 1 — 문서 A 수정 시
[문서 A - RS485(Modbus) 기술 문서 업데이트]

1) 업데이트 섹션:
2) 기존 문서 영향: 없음 (기존 섹션 불변)
3) 추가 내용:
   ...
4) Appendix(선택):
   ...

🟩 템플릿 2 — 문서 B 수정 시
[문서 B - REST API 기술 문서 업데이트]

1) 업데이트 섹션:
2) 기존 문서 영향: 없음 (기존 섹션 불변)
3) 추가 내용:
   ...
4) Appendix(선택):
   ...

🟧 템플릿 3 — 질문이 문서 A/B 중 어디인지 판단 불명확할 때
[문서 선택 제안]

해당 요청은 아래 문서에 속합니다:
- 문서 A: RS485(Modbus → TCP/IP 변환 단계와 직접 관련 있음
- 문서 B: REST API 전환 이후 단계에 해당

권장 문서: (A 또는 B)


4. 응답 스타일
================================================================================
✓ 전문적·단정·간결
✓ 섹션 변화 없음
✓ 예측하는 말 금지
✓ "개발 내용 넣지 말라"고 했으면 절대 코드 추가 금지
✓ 요청한 것만 수행
✓ 문서의 기준·규칙·포맷 유지가 최우선


5. 프로젝트 진행 순서 (고정)
================================================================================
Cursor는 아래 단계를 준수해야 합니다:

1. RS485(Modbus Read/Write 전체 테스트 완성
2. 단일 규격의 TCP/IP 변환 인터페이스 확정
3. 문서 A 완성
4. 문서 A의 모든 기능을 REST API로 매핑
5. 문서 B 완성
6. 이후 통합/협업 진행


6. 코드 파일 구조 (절대 고정)
================================================================================
이 프로젝트는 반드시 3개의 Python 파일로만 구성됩니다:

📄 control_specs.py
   • 제어 명세서 데이터베이스
   • CONTROL_SPECS 딕셔너리 정의
   • 레지스터/비트 주소, 스케일, 단위 등 메타데이터
   • 편의 함수 (get_spec, list_all 등)
   • modbus_tcp_controller와 rest_api_server에서 공통 사용

📄 modbus_tcp_controller.py
   • RS485 Modbus TCP/IP 통신 로직
   • 센서 읽기/쓰기 기본 함수
   • 비트 제어 로직
   • 에러 처리
   • control_specs.py를 import하여 사용

📄 rest_api_server.py
   • modbus_tcp_controller.py와 control_specs.py를 import
   • REST API 엔드포인트 제공
   • JSON 요청/응답
   • HTTP 상태 코드 처리
   • FastAPI 또는 Flask 기반

⚠️ 절대로 추가 파일을 만들지 않습니다.
⚠️ 모든 기능은 위 3개 파일에만 포함됩니다.
⚠️ 역할 분리: 데이터(control_specs) / 로직(modbus) / API(rest)


7. 제어명세서 기반 코드 자동 생성 규칙
================================================================================
사용자가 "제어명세서.txt"에 제어 정보를 입력하면,
AI는 해당 정보를 읽고 자동으로 함수를 생성합니다.

제어명세서 형식:
[제어명]
워드주소: 20
비트번호: 15
설명: 천장 우측 닫기
타입: BIT_WRITE
값범위: 0~1

AI 작업:
1. 제어명세서 파싱
2. modbus_tcp_controller.py에 함수 자동 생성
3. rest_api_server.py에 엔드포인트 자동 생성
4. 일관된 포맷 유지


8. 최종 체크리스트
================================================================================
모든 작업 전 확인:
□ 문서 A와 B를 섞지 않았는가?
□ 기존 섹션을 수정하지 않았는가?
□ 추가 내용은 Appendix로 작성했는가?
□ 코드 파일이 2개를 초과하지 않는가?
□ 요청받은 것만 수행했는가?
□ 포맷과 규칙을 일관되게 유지했는가?


================================================================================
✔️ 이 문서는 모든 AI 작업의 최우선 기준입니다.
✔️ 사용자의 추가 요청이 있어도 이 규칙을 절대 벗어나지 않습니다.
================================================================================

